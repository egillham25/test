"use strict";(self.webpackChunk_grammarly_denali_app=self.webpackChunk_grammarly_denali_app||[]).push([[3321],{41425:(e,t,i)=>{i.d(t,{m:()=>Q,Q:()=>z});var s=i(23988),o=i(10334),n=i(17171),r=i(85886),a=i(65390),l=i(84647),h=i(34553),d=i(56855),p=i(80843),c=i(84712),_=i(99010),u=i(75248),v=i(83694),m=i(84872),b=i(366),y=i(7149),g=i(31206),w=i(79937),C=i(25093),E=i(9079),f=i(11534),x=i(57836),k=i(79),F=i(58655),D=i(21644),A=i(30343),M=i(1395),P=i(40183),S=i(54183),K=i(96011),T=i(97390),$=i(21476),B=i(35098),H=i(19772),L=i(27199),R=i(11864),N=i(13607);const V={position:"absolute",zIndex:N.yg,display:"flex",flexDirection:"column",margin:`${R.Ks.rem(.5)} 0`,padding:`${R.Ks.rem(.5)} 0`,minWidth:R.Ks.percent(100),borderRadius:R.Ks.rem(N.Am),background:L.Q1.CoreNeutral0,boxShadow:L.eu.Z200,opacity:1,transition:"opacity .2s"},W={margin:R.Ks.rem(.5),height:R.Ks.px(1),backgroundColor:L.Q1.CoreNeutral20},I={wrapper:R.Ks.style({position:"relative"}),list:R.Ks.style(V),transparent:R.Ks.style({opacity:0}),hidden:R.Ks.style({display:"none"}),delimiter:R.Ks.style(W)};class O extends K.kp{}class Q extends r.PureComponent{_getHAlign(e){switch(e){case"left":case"auto":return{left:"0"};case"right":return{right:"0"};case"center":return{right:"50%",marginRight:`-${(this._dropdownEl?this._dropdownEl.offsetWidth:0)/2}px`};default:return(0,M.xb)(e)}}_getVAlign(e){switch(e){case"top":return{bottom:"100%"};case"bottom":case"auto":return{top:"100%"};default:return(0,M.xb)(e)}}calcDropdownPosition(){const e=this.props.align,t=this.props.vAlign;this._listPosState.set((0,o._)({},this._getHAlign(e),this._getVAlign(t)));const i="auto"===e,s="auto"===t;(i||s)&&requestAnimationFrame((()=>{if(this._dropdownEl){const n=this._viewport.get(),r=this._dropdownEl.getBoundingClientRect();this._listPosState.set((0,o._)({},this._getHAlign(i?n.right<r.right?"right":"left":e),this._getVAlign(s?n.bottom<r.bottom?"top":"bottom":t)))}}))}componentDidMount(){this._subs.push(this.hovered.pipe(_.M((e=>{this.props.onVisibilityChange&&this.props.onVisibilityChange(e)})),u.K((0,l.pipe)(a.fromNullable(this.props.customPosition),a.fold((()=>v.of(a.none)),(({top:e,left:t})=>m.z(b.br(e),b.br(t)).pipe(y.T(a.some))))))).subscribe(a.fold((()=>this.calcDropdownPosition()),(([e,t])=>this._listPosState.set({top:e,left:t})))),this.context.pipe(g.E("rect")).subscribe(b.H9(this._viewport))),this.props.forceHide&&this._subs.push(this._hidden.pipe(w.n(b.$x(this.props.forceHide.pipe(C.$())))).subscribe((()=>this._hidden.set(!0))))}componentWillUnmount(){this._subs.forEach((e=>e.unsubscribe())),this._subs=[]}UNSAFE_componentWillReceiveProps(){this.calcDropdownPosition()}mapStateToClass(e,t){const i={start:"",end:""};return t?{prev:i,next:{start:I.transparent,end:""}}:{prev:{start:"",end:I.transparent},next:i}}_behavior(e){return"mouseClick"===this.props.appearanceBehavior?{onClickCapture:t=>this._handleClickForAppearanceClick(t,e),onMouseEnter:this._handleMouseEnterForAppearanceClick,onMouseLeave:()=>this._hovered.set(this._initialState)}:{onClickCapture:this._handleClickForAppearanceHover,onMouseEnter:this._handleMouseEnterForAppearanceHover,onMouseLeave:()=>this._hovered.set(this._initialState)}}_labelBehavior(){return{onKeyDown:this._handleLabelKeyDownForAppearance}}_attachDropdownElementBehavior(){var e;null===(e=this._dropdownEl)||void 0===e||e.addEventListener("keydown",(e=>{var t;"Escape"===e.key&&(this._hovered.set(this._initialState),e.preventDefault(),e.stopPropagation(),(null===(t=this._labelRef.current)||void 0===t?void 0:t.firstChild)&&setTimeout((()=>{var e,t;return null===(e=null===(t=this._labelRef.current)||void 0===t?void 0:t.firstChild)||void 0===e?void 0:e.focus()}),0))}))}_handleDropdownElementMount(e){this._dropdownEl=e,this._attachDropdownElementBehavior()}render(){const{label:e,id:t,name:i,ariaLabelledBy:s,theme:a={}}=this.props,h=Boolean(t)?`label-${i}-${t}`:`label-${i}`,c=Boolean(t)?`list-${i}-${t}`:`list-${i}`;return r.createElement($.f.Context.Consumer,null,(t=>r.createElement(T.e.Context.Consumer,null,(i=>r.createElement(T.e.Context.Provider,{value:T.e.withValue(i,{hovered:this._hovered})},r.createElement(d.F.div,(0,n._)((0,o._)({role:"combobox"},(0,p.Ly)(I.wrapper,a.dropdownContainer),this._behavior(t.has($.f.Flag.onlyTrustedEvents))),{"aria-haspopup":"listbox","aria-labelledby":null!=s?s:h,"aria-expanded":b.B8(this._hidden),"aria-controls":c}),r.createElement("label",(0,n._)((0,o._)({id:h},this._labelBehavior()),{ref:this._labelRef}),e),r.createElement(O,{state:this.hovered,stateToClassMapper:this.mapStateToClass},(e=>e.state?r.createElement(d.F.div,null,this._hidden.view((t=>r.createElement(z,(0,n._)((0,o._)({id:c,key:"list",name:this.props.name,onTransitionEnd:"prev"===e.type?()=>this._hidden.set(!0):l.constVoid},(0,p.Ly)(a.dropdownList,e.view)),{mount:this._handleDropdownElementMount.bind(this),style:this._listPosState,hidden:t,activeDescendantId:this.props.activeDescendantId}),this.props.children)))):null))))))))}constructor(...e){super(...e),(0,s._)(this,"context",void 0),(0,s._)(this,"_uuid",P.G7(12)),(0,s._)(this,"_initialState",!1),(0,s._)(this,"_hovered",c.s.create(this._initialState)),(0,s._)(this,"_hidden",c.s.create(!this._initialState)),(0,s._)(this,"_listPosState",c.s.create({})),(0,s._)(this,"_dropdownEl",null),(0,s._)(this,"_subs",[]),(0,s._)(this,"_viewport",c.s.create(S.rw.empty)),(0,s._)(this,"_labelRef",r.createRef()),(0,s._)(this,"hovered",this._hovered.pipe(E.J(),w.n((([e,t])=>t?f.O1(this.props.showDelay).pipe(x.u(!0)):e?f.O1(void 0===this.props.closeDelay?Q.defaultProps.closeDelay:this.props.closeDelay).pipe(x.u(!1)):v.of(!1))),k.h(Q._hoveredForce.pipe(y.T(a.exists((e=>e===this._uuid))))),F.F(),_.M((e=>e&&Q._hoveredForce.next(a.some(this._uuid)))),_.M((e=>e&&this._hidden.set(!1))),D.u(),A.Z(this._initialState))),(0,s._)(this,"_handleClickForAppearanceHover",(e=>{const t=e.target;if(S.d6(t)||!0===this.props.dontCloseOnClickInside)return;const i=!S.ws(t,I.list);Q._hoveredForce.next(i?a.some(this._uuid):a.none),this._hovered.set(i)})),(0,s._)(this,"_handleMouseEnterForAppearanceHover",(()=>{this._hovered.set(!0)})),(0,s._)(this,"_handleClickForAppearanceClick",((e,t)=>{t&&!e.isTrusted||(this._hovered.get()?this._handleClickForAppearanceHover(e):this._hovered.set(!0))})),(0,s._)(this,"_handleMouseEnterForAppearanceClick",(e=>{const t=e.target;S.ws(t,I.list)&&(Q._hoveredForce.next(a.some(this._uuid)),this._hovered.set(!0))})),(0,s._)(this,"_handleLabelKeyDownForAppearance",(e=>{"Enter"!==e.key&&" "!==e.key||(this._hovered.set(!0),e.preventDefault())}))}}(0,s._)(Q,"defaultProps",{align:"auto",vAlign:"auto",showDelay:500,closeDelay:500,appearanceBehavior:"mouseHover"}),(0,s._)(Q,"Delimiter",(()=>r.createElement("div",{className:I.delimiter}))),(0,s._)(Q,"_hoveredForce",new h.B),(0,s._)(Q,"contextType",B.L.Context);const z=e=>{const{ref:t,onMount:i}=H.R.useElWatcher();return H.R.FocusTrap.useFocusTrap(t),r.createElement(T.e.Context.Consumer,null,(t=>{const s=T.e.emptyWithName(`${void 0!==t.name?`${t.name}/`:""}dropdown-${e.name}`);return r.createElement(T.e.Context.Provider,{value:s},r.createElement(d.F.div,(0,n._)((0,o._)({id:e.id},(0,p.Ly)(e.className,!0===e.hidden?I.hidden:I.list)),{style:e.style,mount:t=>{i(t),void 0!==e.mount&&e.mount(t)},role:"listbox","aria-labelledby":e.ariaLabelledBy,"data-role":"dropdown-list","data-name":"dropdown-"+e.name,"aria-activedescendant":e.activeDescendantId,onTransitionEnd:e.onTransitionEnd}),e.children))}))}}}]);